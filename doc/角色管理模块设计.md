# 角色管理模块设计

## 1. 功能描述

角色管理模块主要实现对系统角色的管理，重点是角色权限分配功能。主要功能包括：

- 角色权限分配：为角色分配菜单权限和数据权限，控制用户访问范围
- 角色列表查询：支持按角色名称、状态等条件查询
- 角色基础管理：维护角色的基本信息（名称、权限范围、状态等）

## 2. 详细设计

### (1) 功能组件表

角色管理功能组件表如表 1 所示。

表 1 角色管理功能组件表

| 功能层次 | 类或页面 | 方法或请求 | 说明 |
| --- | --- | --- | --- |
| View | role.vue | handleAuthData() | 处理权限分配 |
| Controller | SysRoleController | authDataScope() | 更新权限范围 |
| Service | SysRoleService | authDataScope() | 权限业务处理 |
| Mapper | SysRoleMapper | updateRole() | 数据库操作 |
| Domain | SysRole | get/set | 角色实体类 |

### (2) 类的调用时序模型

角色权限分配时序模型如图 1 所示。

```
+--------+    +--------+    +--------+    +--------+    +--------+    +--------+
|        |    |        |    |        |    |        |    |        |    |        |
| 管理员  |    |role.vue|    |Role    |    |Role    |    |Role    |    |SysRole |
|        |    |        |    |Control. |    |Service |    |Mapper  |    |        |
+--------+    +--------+    +--------+    +--------+    +--------+    +--------+
    |             |             |             |             |             |
    | 访问         |             |             |             |             |
    |------------>|             |             |             |             |
    |             |             |             |             |             |
    |             | handleAuth  |             |             |             |
    |             |------------>|             |             |             |
    |             |             |             |             |             |
    |             |             | authData    |             |             |
    |             |             |------------>|             |             |
    |             |             |             |             |             |
    |             |             |             | updateRole  |             |
    |             |             |             |------------>|             |
    |             |             |             |             |             |
    |             |             |             |             | get/set     |
    |             |             |             |             |------------>|
    |             |             |             |             |             |
    |             |             |             |             |<------------|
    |             |             |             |             | return      |
    |             |             |             |<------------| return      |
    |             |             |             | return      |             |
    |             |             |<------------| return      |             |
    |             |             | return      |             |             |
    |             |<------------| return      |             |             |
    |             | return      |             |             |             |
    |<------------| return      |             |             |             |
    |             |             |             |             |             |
```

### (3) 执行流程描述

1. 角色权限分配流程
   - 点击权限分配按钮，打开权限设置对话框
   - 选择菜单权限（功能权限）和数据权限
   - 调用 handleAuthData() 函数处理权限数据
   - 调用 authDataScope() 接口保存权限数据
   - 调用 updateRole() 方法更新数据库
   - 保存成功后刷新列表

2. 角色基础管理流程
   - 点击编辑按钮，打开角色信息编辑对话框
   - 修改角色基本信息（名称、权限范围、状态等）
   - 调用 handleRoleInfo() 函数处理表单数据
   - 调用 updateRole() 接口保存角色数据
   - 保存成功后刷新列表